<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>AI Mock HR Interview</title>
    <style>
      :root {
        --bg-dark: #020617;
        --bg-light: #f4f6f8;
        --card-dark: #0f172a;
        --card-light: #ffffff;
        --text-dark: #e5e7eb;
        --text-light: #020617;
      }
      body {
        font-family: Arial, sans-serif;
        background: var(--bg-dark);
        color: var(--text-dark);
        padding: 20px;
        transition: 0.4s;
      }
      body.light {
        background: var(--bg-light);
        color: var(--text-light);
      }
      h1 {
        text-align: center;
        margin-bottom: 25px;
      }
      .container {
        display: flex;
        gap: 30px;
        justify-content: center;
        flex-wrap: wrap;
      }
      .card {
        background: var(--card-dark);
        width: 420px;
        padding: 20px;
        border-radius: 12px;
        box-shadow: 0 6px 18px rgba(0, 0, 0, 0.3);
        text-align: center;
      }
      body.light .card {
        background: var(--card-light);
      }
      video,
      img {
        width: 100%;
        height: 260px;
        border-radius: 10px;
        object-fit: cover;
      }
      .ai-speaking {
        box-shadow: 0 0 25px #00c6ff, 0 0 50px #00c6ff;
        animation: pulseGlow 1.2s infinite alternate;
      }
      @keyframes pulseGlow {
        from {
          box-shadow: 0 0 15px #00c6ff;
        }
        to {
          box-shadow: 0 0 45px #00c6ff;
        }
      }
      #aiQuestion {
        font-size: 18px;
        font-weight: bold;
        min-height: 50px;
        margin-top: 15px;
      }
      #userAnswer {
        font-size: 16px;
        min-height: 60px;
        margin-top: 10px;
        text-align: left;
      }
      .center {
        text-align: center;
        margin-top: 30px;
      }
      button {
        padding: 12px 24px;
        font-size: 16px;
        border: none;
        border-radius: 6px;
        cursor: pointer;
        margin: 8px;
      }
      #startBtn {
        background: #6c757d;
        color: white;
      }
      #recordBtn {
        background: #007bff;
        color: white;
      }
      #stopBtn {
        background: #28a745;
        color: white;
      }
      button:disabled {
        background: #aaa;
        cursor: not-allowed;
      }
      #recordingIndicator {
        color: red;
        font-weight: bold;
        display: none;
      }
      .theme-toggle {
        position: fixed;
        top: 15px;
        right: 20px;
        background: none;
        border: none;
        font-size: 20px;
        cursor: pointer;
        color: inherit;
      }
      .close-btn {
        position: fixed;
        top: 15px;
        left: 20px;
        background: #dc3545;
        color: #fff;
        padding: 8px 14px;
        border-radius: 6px;
        font-size: 14px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <button class="close-btn" onclick="closeInterview()">âœ– Close</button>
    <button class="theme-toggle" onclick="toggleTheme()">ðŸŒ™ / â˜€</button>
    <h1>AI Mock HR Interview</h1>
    <div class="container">
      <div class="card">
        <h2>You</h2>
        <video id="userVideo" autoplay muted playsinline></video>
        <p id="userAnswer"><strong>Your Answer:</strong></p>
        <p id="recordingIndicator">Recording...</p>
      </div>
      <div class="card">
        <h2>AI Interviewer</h2>
        <img
          id="aiImage"
          src="{{ url_for('static', filename='ai_robot.jpg') }}"
        />
        <p id="aiQuestion">Click Start Interview</p>
      </div>
    </div>
    <div class="center">
      <button id="startBtn">Start Interview</button>
      <button id="recordBtn" disabled>Record</button>
      <button id="stopBtn" disabled>Stop</button>
    </div>
    <script>
      function toggleTheme() {
        document.body.classList.toggle("light");
      }
      function closeInterview() {
        if (stream) stream.getTracks().forEach((t) => t.stop());
        window.history.back();
      }
      /* ===== 50 QUESTIONS ===== */ const QUESTIONS = [
        "Tell me about yourself",
        "What are your strengths?",
        "What are your weaknesses?",
        "Why should we hire you?",
        "Where do you see yourself in five years?",
        "Describe a challenge you faced",
        "How do you handle pressure?",
        "What motivates you?",
        "Tell me about a failure",
        "What are your career goals?",
        "How do you handle criticism?",
        "What do you know about our company?",
        "Why did you choose this field?",
        "How do you manage time?",
        "What is your biggest achievement?",
        "Describe teamwork experience",
        "How do you solve problems?",
        "Are you a leader or follower?",
        "How do you handle conflicts?",
        "What makes you unique?",
        "What are your hobbies?",
        "How do you learn new skills?",
        "What are your short-term goals?",
        "What are your long-term goals?",
        "How do you stay motivated?",
        "Describe your work ethic",
        "How do you adapt to change?",
        "What inspires you?",
        "How do you handle deadlines?",
        "How do you handle stress?",
        "What do you expect from this role?",
        "What kind of work environment do you prefer?",
        "How do you prioritize tasks?",
        "Describe your communication skills",
        "How do you deal with failure?",
        "What is your ideal job?",
        "What do you do under pressure?",
        "How do you define success?",
        "Why should we trust you?",
        "How do you improve yourself?",
        "What are your technical skills?",
        "How do you stay organized?",
        "Describe a difficult decision",
        "How do you handle mistakes?",
        "What are your values?",
        "What does teamwork mean to you?",
        "How do you manage expectations?",
        "What are you passionate about?",
        "Why do you want this job?",
      ];
      /* ===== MODEL ANSWERS FOR 50 QUESTIONS ===== */
      /* ===== FULL 50 MODEL ANSWERS ===== */
      const MODEL_ANSWERS = {
        "Tell me about yourself":
          "My name is ___ and I am from ___. I recently completed my education and developed a strong interest in learning new technologies. I enjoy problem-solving and continuous self-improvement. I am disciplined, motivated, and goal-oriented. I am looking for an opportunity to grow professionally.",

        "What are your strengths?":
          "My strengths include adaptability, quick learning, and dedication. I work well in team environments and communicate clearly. I am good at managing my time and meeting deadlines. I stay calm under pressure. I always try to give my best effort.",

        "What are your weaknesses?":
          "One of my weaknesses is being too focused on perfection. I am learning to balance quality and time effectively. I take feedback positively. I continuously work on self-improvement. This helps me grow professionally.",

        "Why should we hire you?":
          "I am hardworking and eager to learn. I adapt quickly to new challenges. I take responsibility for my work. I believe in teamwork and honesty. I am committed to contributing positively to the organization.",

        "Where do you see yourself in five years?":
          "In five years, I see myself as a skilled professional. I want to gain strong industry experience. I aim to take on more responsibilities. I plan to grow technically and personally. I want to contribute to organizational success.",

        "Describe a challenge you faced":
          "I once faced difficulty managing multiple tasks. I created a priority list to manage time. I stayed focused and organized. This helped me complete tasks efficiently. The experience improved my planning skills.",

        "How do you handle pressure?":
          "I handle pressure by staying calm and focused. I break tasks into smaller steps. Planning helps me manage workload. I avoid panic and stay confident. Pressure motivates me to perform better.",

        "What motivates you?":
          "Learning new things motivates me. Achieving goals gives me satisfaction. Feedback helps me improve. Challenges push me forward. Growth keeps me inspired.",

        "Tell me about a failure":
          "I once failed due to poor planning. I analyzed what went wrong. I learned from my mistakes. I improved my approach next time. Failure helped me become more responsible.",

        "What are your career goals?":
          "My goal is to build a stable career. I want to enhance my technical skills. I aim to gain industry experience. I want to take leadership roles. Long-term growth is important to me.",

        "How do you handle criticism?":
          "I accept criticism positively. I see it as an opportunity to improve. I analyze feedback carefully. I work on my weak areas. This helps me grow continuously.",

        "What do you know about our company?":
          "Your company has a strong reputation in the industry. It focuses on innovation and quality. I admire its work culture. The company values growth and learning. I want to contribute to its success.",

        "Why did you choose this field?":
          "I chose this field because of my interest. I enjoy learning related skills. It allows continuous growth. The field offers new challenges. I feel motivated working in it.",

        "How do you manage time?":
          "I plan my tasks in advance. I set priorities. I avoid procrastination. I follow schedules strictly. Time management helps me stay productive.",

        "What is your biggest achievement?":
          "Completing my projects successfully is my biggest achievement. I stayed consistent and focused. I learned many skills. It boosted my confidence. It prepared me for real-world challenges.",

        "Describe teamwork experience":
          "I have worked in team projects. I communicate openly with team members. I support others when needed. Teamwork improves efficiency. Collaboration helps achieve better results.",

        "How do you solve problems?":
          "I analyze the problem carefully. I break it into parts. I explore possible solutions. I choose the best approach. I verify results after implementation.",

        "Are you a leader or follower?":
          "I can be both when needed. I take responsibility as a leader. I follow guidance when required. I respect teamwork. Flexibility is my strength.",

        "How do you handle conflicts?":
          "I handle conflicts calmly. I listen to all perspectives. I communicate respectfully. I focus on solutions. Mutual understanding is important.",

        "What makes you unique?":
          "My dedication makes me unique. I am always eager to learn. I adapt quickly. I stay positive during challenges. I continuously improve myself.",

        "What are your hobbies?":
          "My hobbies include learning new skills. I enjoy reading and exploring technology. I like problem-solving. Hobbies refresh my mind. They improve creativity.",

        "How do you learn new skills?":
          "I learn through practice and consistency. I use online resources. I apply what I learn. I seek feedback. Continuous learning is my habit.",

        "What are your short-term goals?":
          "My short-term goal is gaining experience. I want to improve my skills. I aim to perform well. I want to learn industry standards. Growth is my focus.",

        "What are your long-term goals?":
          "My long-term goal is career stability. I want leadership responsibilities. I aim to become an expert. I want to contribute to innovation. Growth matters to me.",

        "How do you stay motivated?":
          "I set clear goals. I track progress. I celebrate small achievements. Challenges inspire me. Motivation keeps me focused.",

        "Describe your work ethic":
          "I believe in honesty and discipline. I respect deadlines. I give my best effort. I take responsibility seriously. Quality work is important to me.",

        "How do you adapt to change?":
          "I accept change positively. I learn new methods. I stay flexible. Adaptability helps growth. Change improves skills.",

        "What inspires you?":
          "Success stories inspire me. Learning inspires growth. Challenges motivate improvement. Hard work inspires discipline. Progress keeps me inspired.",

        "How do you handle deadlines?":
          "I plan tasks early. I avoid last-minute stress. I prioritize important work. I stay disciplined. Deadlines keep me focused.",

        "How do you handle stress?":
          "I stay calm under stress. I organize tasks. I take short breaks. Planning reduces stress. Positive thinking helps.",

        "What do you expect from this role?":
          "I expect learning opportunities. I want growth and challenges. I seek responsibility. I want to improve skills. I aim to contribute effectively.",

        "What kind of work environment do you prefer?":
          "I prefer a positive environment. Team collaboration matters. Open communication is important. Learning culture motivates me. Respect improves productivity.",

        "How do you prioritize tasks?":
          "I list tasks by importance. I focus on deadlines. I manage time wisely. Planning helps execution. Prioritization improves efficiency.",

        "Describe your communication skills":
          "I communicate clearly and respectfully. I listen actively. I express ideas confidently. Communication avoids misunderstandings. It improves teamwork.",

        "How do you deal with failure?":
          "I analyze failures calmly. I learn lessons. I improve strategies. Failure builds experience. Growth follows mistakes.",

        "What is your ideal job?":
          "My ideal job offers growth. It challenges my skills. Learning is continuous. Teamwork is valued. Contribution matters.",

        "What do you do under pressure?":
          "I stay calm and focused. I prioritize tasks. I avoid panic. Planning helps control pressure. Pressure improves performance.",

        "How do you define success?":
          "Success means continuous improvement. Achieving goals matters. Learning from failures counts. Growth defines success. Satisfaction is important.",

        "Why should we trust you?":
          "I am honest and responsible. I respect commitments. I communicate openly. I take accountability seriously. Trust builds success.",

        "How do you improve yourself?":
          "I learn daily. I seek feedback. I practice consistently. I analyze mistakes. Improvement is ongoing.",

        "What are your technical skills?":
          "I have foundational technical skills. I keep learning new tools. I practice regularly. I improve through projects. Skills grow with experience.",

        "How do you stay organized?":
          "I plan daily tasks. I use schedules. I maintain priorities. Organization saves time. Discipline keeps me efficient.",

        "Describe a difficult decision":
          "I analyze all options carefully. I consider consequences. I seek advice if needed. I choose logically. Decisions build experience.",

        "How do you handle mistakes?":
          "I accept mistakes honestly. I correct them quickly. I learn lessons. Mistakes improve skills. Responsibility matters.",

        "What are your values?":
          "Honesty is my core value. Discipline guides me. Respect matters. Responsibility is important. Values define character.",

        "What does teamwork mean to you?":
          "Teamwork means collaboration. Supporting each other matters. Communication is key. Shared goals unite teams. Success is collective.",

        "How do you manage expectations?":
          "I communicate clearly. I set realistic goals. I manage time properly. Transparency avoids issues. Expectations guide performance.",

        "What are you passionate about?":
          "I am passionate about learning. I enjoy skill development. Problem-solving excites me. Growth motivates me. Passion drives success.",

        "Why do you want this job?":
          "This role aligns with my goals. It offers learning opportunities. I admire the organization. I want to contribute. Growth motivates me.",
      };

      function getRandomQuestions() {
        return [...QUESTIONS].sort(() => Math.random() - 0.5).slice(0, 5);
      }
      let questions = [];
      let qIndex = 0;
      let recognition;
      let finalTranscript = "";
      let results = [];
      let stream = null;
      const userAnswerEl = document.getElementById("userAnswer");
      const aiQuestionEl = document.getElementById("aiQuestion");
      const aiImage = document.getElementById("aiImage");
      const recordBtn = document.getElementById("recordBtn");
      const stopBtn = document.getElementById("stopBtn");
      const startBtn = document.getElementById("startBtn");
      const indicator = document.getElementById("recordingIndicator");
      /* âœ… CAMERA FIX */ async function startCamera() {
        try {
          const video = document.getElementById("userVideo");
          stream = await navigator.mediaDevices.getUserMedia({ video: true });
          video.srcObject = stream;
          await video.play();
        } catch (err) {
          alert("Camera permission denied or camera not available");
          console.error(err);
        }
      }
      function speak(text, cb) {
        const msg = new SpeechSynthesisUtterance(text);
        aiImage.classList.add("ai-speaking");
        msg.onend = () => {
          aiImage.classList.remove("ai-speaking");
          if (cb) cb();
        };
        speechSynthesis.speak(msg);
      }
      function askQuestion() {
        if (qIndex >= questions.length) {
          localStorage.setItem("interviewResults", JSON.stringify(results));
          window.location.href = "/result";
          return;
        }
        userAnswerEl.innerHTML = "<strong>Your Answer:</strong>";
        aiQuestionEl.innerText = questions[qIndex];
        speak(questions[qIndex], () => {
          recordBtn.disabled = false;
        });
        qIndex++;
      }
      async function startRecording() {
        const SpeechRecognition =
          window.SpeechRecognition || window.webkitSpeechRecognition;
        if (!SpeechRecognition) {
          alert("Speech Recognition works only in Google Chrome");
          return;
        }
        await navigator.mediaDevices.getUserMedia({ audio: true });
        finalTranscript = "";
        indicator.style.display = "block";
        recognition = new SpeechRecognition();
        recognition.lang = "en-US";
        recognition.continuous = true;
        recognition.interimResults = true;
        recognition.onresult = (e) => {
          let interim = "";
          for (let i = e.resultIndex; i < e.results.length; i++) {
            const txt = e.results[i][0].transcript;
            if (e.results[i].isFinal) finalTranscript += txt + " ";
            else interim += txt;
          }
          userAnswerEl.innerHTML =
            "<strong>Your Answer:</strong> " +
            finalTranscript +
            "<i style='opacity:0.6'>" +
            interim +
            "</i>";
        };
        recognition.start();
        recordBtn.disabled = true;
        stopBtn.disabled = false;
      }
      function stopRecording() {
        recognition.stop();
        indicator.style.display = "none";
        const wc = finalTranscript.trim().split(/\s+/).length;
        const score = Math.min(Math.floor(wc / 10) * 2, 20);
        results.push({
          question: questions[qIndex - 1],
          answer: finalTranscript || "No answer",
          score,
        });
        stopBtn.disabled = true;
        askQuestion();
      }
      startBtn.onclick = async () => {
        questions = getRandomQuestions();
        qIndex = 0;
        results = [];
        await startCamera();
        startBtn.disabled = true;
        askQuestion();
      };
      recordBtn.onclick = startRecording;
      stopBtn.onclick = stopRecording;
    </script>
  </body>
</html>
